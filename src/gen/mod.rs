mod rewrite;
mod transfer;

use crate::{Aig, Mig, Network, Xag, Xmg};
use indoc::formatdoc;

pub fn network_ffi<N: Network>() -> String {
    format!(
        "{}{}{}{}{}",
        transfer::receiver_struct::<N>(),
        transfer::send_helper::<N>(),
        transfer::receive_helper::<N>(),
        rewrite::rewrite_struct::<N>(),
        rewrite::rewrite_helper::<N>()
    )
}

pub fn ffi_header() -> String {
    formatdoc!(
        r#"
        // Automatically generated by eggmock v{}
        #pragma once

        #include <cstddef>
        #include <cstdint>
        #include <stdexcept>

        #include <mockturtle/mockturtle.hpp>

        namespace eggmock
        {{
        {}
        {}
        {}
        {}
        }}
        "#,
        env!("CARGO_PKG_VERSION"),
        network_ffi::<Mig>(),
        network_ffi::<Aig>(),
        network_ffi::<Xag>(),
        network_ffi::<Xmg>()
    )
}
